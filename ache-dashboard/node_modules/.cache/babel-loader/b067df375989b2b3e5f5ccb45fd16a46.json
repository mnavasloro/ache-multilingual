{"ast":null,"code":"import _classCallCheck from\"C:/Users/mnavas/CODE/SmartBIC/ache-multilingual/ache-dashboard/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/mnavas/CODE/SmartBIC/ache-multilingual/ache-dashboard/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/Users/mnavas/CODE/SmartBIC/ache-multilingual/ache-dashboard/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/mnavas/CODE/SmartBIC/ache-multilingual/ache-dashboard/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Link}from'react-router-dom';import{api}from'./RestApi';import{AlertMessage,AlertMessages}from'./AlertMessage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CrawlersTable=/*#__PURE__*/function(_React$Component){_inherits(CrawlersTable,_React$Component);var _super=_createSuper(CrawlersTable);function CrawlersTable(){_classCallCheck(this,CrawlersTable);return _super.apply(this,arguments);}_createClass(CrawlersTable,[{key:\"render\",value:function render(){var crawlerManager=this.props.crawlerManager;var crawlerList=this.props.crawlers;return/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Crawler ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:crawlerList.map(function(crawler,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:crawler.crawlerId}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"label label-default\",children:crawler.crawlerState})}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn btn-default btn-sm\",disabled:!crawler.crawlerRunning,onClick:function onClick(e){return crawlerManager.stopCrawl(crawler.crawlerId);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"glyphicon glyphicon-stop\"}),\" Stop Crawler\"]}),\"\\xA0\",/*#__PURE__*/_jsxs(Link,{className:\"btn btn-default btn-sm\",to:'/monitoring/'+crawler.crawlerId,children:[/*#__PURE__*/_jsx(\"i\",{className:\"glyphicon glyphicon-signal\"}),\"\\xA0Monitoring\"]}),\"\\xA0\",/*#__PURE__*/_jsxs(Link,{className:\"btn btn-default btn-sm\",to:'/search/'+crawler.crawlerId,disabled:!crawler.searchEnabled,children:[/*#__PURE__*/_jsx(\"i\",{className:\"glyphicon glyphicon-search\"}),\"\\xA0Search\"]})]})]},crawler.crawlerId+crawler.crawlerState);})})]})});}}]);return CrawlersTable;}(React.Component);var Crawlers=/*#__PURE__*/function(_React$Component2){_inherits(Crawlers,_React$Component2);var _super2=_createSuper(Crawlers);function Crawlers(props){var _this;_classCallCheck(this,Crawlers);_this=_super2.call(this,props);_this.messages=_this.props.messages;_this.state={};_this.fetchCrawlersList();return _this;}_createClass(Crawlers,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.timerID=setInterval(function(){return _this2.fetchCrawlersList();},2000// update status every 2s\n);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearInterval(this.timerID);}},{key:\"fetchCrawlersList\",value:function fetchCrawlersList(){var _this3=this;api.get('/crawls').then(function(response){if(response==='FETCH_ERROR'){if(!_this3.state.serverError){_this3.messages.error('Failed to connect to ACHE server.');_this3.setState({serverError:true});}}else{_this3.setState({serverError:false,crawlers:response.crawlers});}});}},{key:\"stopCrawl\",value:function stopCrawl(crawlerId){var config={mode:'cors'};api.get('/crawls/'+crawlerId+'/stopCrawl',config).then(this.updateResponse.bind(this));}},{key:\"updateResponse\",value:function updateResponse(response){if('FETCH_ERROR'===response){if(!this.state.serverError){this.messages.error('Failed to connect to ACHE server.');this.setState({serverError:true});}}else{this.setState({serverError:false});if(response.shutdownInitiated===false){this.messages.error('Failed to initiate crawler shutdown.');}else if(response.shutdownInitiated===true){this.messages.success('Crawler shutdown initiated.');}}}},{key:\"render\",value:function render(){var hasCrawlers=this.state.crawlers&&this.state.crawlers.length>0;var crawlersTable;if(hasCrawlers){crawlersTable=/*#__PURE__*/_jsx(CrawlersTable,{crawlers:this.state.crawlers,crawlerManager:this});}return/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12\",children:[/*#__PURE__*/_jsx(AlertMessages,{messages:this.messages.display()}),/*#__PURE__*/_jsx(\"h2\",{children:\"Crawlers\"}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(Link,{className:\"btn btn-default\",to:\"/start\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"glyphicon glyphicon-plus\"}),\"\\xA0Start Crawler\"]})}),hasCrawlers&&crawlersTable,!hasCrawlers&&/*#__PURE__*/_jsx(AlertMessage,{message:{type:'warn',message:'No crawlers available. Click on \"Start Crawl\" to start a crawler.'}})]})});}}]);return Crawlers;}(React.Component);export default Crawlers;","map":{"version":3,"names":["React","Link","api","AlertMessage","AlertMessages","CrawlersTable","crawlerManager","props","crawlerList","crawlers","map","crawler","index","crawlerId","crawlerState","crawlerRunning","e","stopCrawl","searchEnabled","Component","Crawlers","messages","state","fetchCrawlersList","timerID","setInterval","clearInterval","get","then","response","serverError","error","setState","config","mode","updateResponse","bind","shutdownInitiated","success","hasCrawlers","length","crawlersTable","display","type","message"],"sources":["C:/Users/mnavas/CODE/SmartBIC/ache-multilingual/ache-dashboard/src/Crawlers.js"],"sourcesContent":["import React from 'react';\r\n\r\nimport {Link} from 'react-router-dom'\r\nimport {api} from './RestApi';\r\n\r\nimport {AlertMessage, AlertMessages} from './AlertMessage'\r\n\r\nclass CrawlersTable extends React.Component {\r\n  render() {\r\n    const crawlerManager = this.props.crawlerManager;\r\n    const crawlerList = this.props.crawlers;\r\n    return (\r\n      <div className=\"table-responsive\">\r\n        <table className=\"table table-striped table-bordered\">\r\n          <thead>\r\n            <tr>\r\n              <th>#</th>\r\n              <th>Crawler ID</th>\r\n              <th>Status</th>\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n          { crawlerList.map((crawler, index) =>\r\n              <tr key={crawler.crawlerId+crawler.crawlerState} >\r\n                <td>{index + 1}</td>\r\n                <td>{crawler.crawlerId}</td>\r\n                <td><span className=\"label label-default\">{crawler.crawlerState}</span></td>\r\n                <td>\r\n                  <button type=\"button\" className=\"btn btn-default btn-sm\"\r\n                    disabled={!crawler.crawlerRunning} onClick={(e)=>crawlerManager.stopCrawl(crawler.crawlerId)}>\r\n                      <i className=\"glyphicon glyphicon-stop\"></i> Stop Crawler\r\n                  </button>\r\n                  &nbsp;\r\n                  <Link className=\"btn btn-default btn-sm\" to={'/monitoring/'+crawler.crawlerId}>\r\n                    <i className=\"glyphicon glyphicon-signal\" />&nbsp;Monitoring\r\n                  </Link>\r\n                  &nbsp;\r\n                  <Link className=\"btn btn-default btn-sm\" to={'/search/'+crawler.crawlerId} disabled={!crawler.searchEnabled}>\r\n                    <i className=\"glyphicon glyphicon-search\" />&nbsp;Search\r\n                  </Link>\r\n                </td>\r\n              </tr>\r\n          )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass Crawlers extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.messages = this.props.messages;\r\n    this.state = {};\r\n    this.fetchCrawlersList();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.timerID = setInterval(\r\n      () => this.fetchCrawlersList(),\r\n      2000 // update status every 2s\r\n    );\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    clearInterval(this.timerID);\r\n  }\r\n\r\n  fetchCrawlersList() {\r\n    api.get('/crawls')\r\n      .then( (response) => {\r\n        if (response === 'FETCH_ERROR') {\r\n          if(!this.state.serverError) {\r\n            this.messages.error('Failed to connect to ACHE server.');\r\n            this.setState({serverError: true});\r\n          }\r\n        } else {\r\n          this.setState({serverError: false, crawlers: response.crawlers});\r\n        }\r\n      });\r\n  }\r\n\r\n  stopCrawl(crawlerId) {\r\n    var config = {mode: 'cors'};\r\n    api.get('/crawls/' + crawlerId + '/stopCrawl', config)\r\n       .then(this.updateResponse.bind(this));\r\n  }\r\n\r\n  updateResponse(response) {\r\n    if('FETCH_ERROR' === response) {\r\n      if(!this.state.serverError) {\r\n        this.messages.error('Failed to connect to ACHE server.');\r\n        this.setState({serverError: true});\r\n      }\r\n    } else {\r\n      this.setState({serverError: false});\r\n      if(response.shutdownInitiated === false) {\r\n        this.messages.error('Failed to initiate crawler shutdown.');\r\n      } else if(response.shutdownInitiated === true) {\r\n        this.messages.success('Crawler shutdown initiated.');\r\n      }\r\n    }\r\n  }\r\n\r\n  render(){\r\n\r\n    const hasCrawlers = (this.state.crawlers && this.state.crawlers.length > 0);\r\n\r\n    let crawlersTable;\r\n    if(hasCrawlers) {\r\n      crawlersTable = <CrawlersTable crawlers={this.state.crawlers} crawlerManager={this} />;\r\n    }\r\n    return (\r\n      <div className=\"row\">\r\n        <div className=\"col-md-12\">\r\n          <AlertMessages messages={this.messages.display()} />\r\n          <h2>Crawlers</h2>\r\n          <p>\r\n            <Link className=\"btn btn-default\" to='/start'><i className=\"glyphicon glyphicon-plus\" />&nbsp;Start Crawler</Link>\r\n          </p>\r\n          { hasCrawlers && crawlersTable }\r\n          {\r\n            !hasCrawlers &&\r\n            <AlertMessage message={{type: 'warn', message: 'No crawlers available. Click on \"Start Crawl\" to start a crawler.'}} />\r\n          }\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n  }\r\n\r\n}\r\n\r\nexport default Crawlers;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}